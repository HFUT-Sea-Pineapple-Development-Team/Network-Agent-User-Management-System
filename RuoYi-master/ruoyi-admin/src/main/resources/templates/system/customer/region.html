<!DOCTYPE html>
<html style="height: 100%" lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
	<meta charset="utf-8">
</head>
<body style="height: 100%; margin: 0">
     <div id="container" style="height: 100%"></div>

        <script type="text/javascript" th:src="@{/js/plugins/echarts/echarts.min.js}"></script>
        <!-- Uncomment this line if you want to dataTool extension
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@{{version}}/dist/extension/dataTool.min.js"></script>
        -->
        <!-- Uncomment this line if you want to use gl extension
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
        -->
        <!-- Uncomment this line if you want to echarts-stat extension
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
        -->
        <!-- Uncomment this line if you want to use map-->
        <script type="text/javascript" th:src="@{/js/plugins/echarts/china.js}"></script>
        <script type="text/javascript" th:src="@{/js/plugins/echarts/world.js}"></script>
        <!-- Uncomment these two lines if you want to use bmap extension-->
        <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=8mxWpmlcNAE1OTHN0W9B9tRUq5O3xB1L"></script>
        <script type="text/javascript" th:src="@{/js/plugins/echarts/bmap.min.js}"></script>
        
    <th:block th:include="include :: footer" />
    <script th:inline="javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var app = {};

    var option;
    var prefix = ctx + "system/customer";

        var data = [

        	  { name: '西藏', value: 0 },
        	  { name: '上海', value: 0 },
        	  { name: '福建', value: 0 },
        	  { name: '广西', value: 0 },
        	  { name: '广东', value: 0 },
        	  { name: '山西', value: 0 },
        	  { name: '云南', value: 0 },
        	  { name: '海南', value: 0 },
        	  { name: '辽宁', value: 0 },
        	  { name: '吉林', value: 0 },
        	  { name: '宁夏', value: 0 },
        	  { name: '江西', value: 0 },
        	  { name: '青海', value: 0 },
        	  { name: '内蒙古', value: 0 },
        	  { name: '四川', value: 0 },
        	  { name: '陕西', value: 0 },
        	  { name: '江苏', value: 0 },
        	  { name: '贵州', value: 0 },
        	  { name: '北京', value: 0 },
        	  { name: '新疆', value: 0 },
        	  { name: '浙江', value: 0 },
        	  { name: '山东', value: 0 },
        	  { name: '重庆', value: 0 },
        	  { name: '甘肃', value: 0 },
        	  { name: '天津', value: 0 },
        	  { name: '河南', value: 0 },
        	  { name: '黑龙江', value: 0 },
        	  { name: '河北', value: 0 },
        	  { name: '湖南', value: 0 },
        	  { name: '安徽', value: 0 },
        	  { name: '湖北', value: 0 },
        	];
        
        const geoCoordMap = {
        		  西藏: [91.11, 29.97],
        		  上海: [121.48, 31.22],
        		  福建: [119.3, 26.08],
        		  广西: [108.33, 22.84],
        		  广东: [113.23, 23.16],
        		  山西: [112.53, 37.87],
        		  云南: [102.73, 25.04],
        		  海南: [110.35, 20.02],
        		  辽宁: [123.38, 41.8],
        		  吉林: [125.35, 43.88],
        		  宁夏: [106.27, 38.47],
        		  江西: [115.89, 28.68],
        		  青海: [101.74, 36.56],
        		  内蒙古: [111.65, 40.82],
        		  四川: [104.06, 30.67],
        		  陕西: [108.95, 34.27],
        		  重庆: [106.54, 29.59],
        		  江苏: [119.78, 32.74],
        		  贵州: [106.71, 26.57],
        		  北京: [116.46, 39.92],
        		  新疆: [87.68, 43.77],
        		  浙江: [120.19, 29.26],
        		  山东: [117, 36.65],
        		  甘肃: [103.73, 36.03],
        		  天津: [117.2, 39.13],
        		  河南: [113.65, 34.76],
        		  黑龙江: [126.63, 45.75],
        		  河北: [114.48, 38.03],
        		  湖南: [113, 28.21],
        		  安徽: [117.27, 31.46],
        		  湖北: [114.31, 30.52],
        		};
        
        $(function() {
            console.log([[${regiondis}]])
            var regiondis = [[${regiondis}]]
            console.log(regiondis.length)
            console.log(regiondis[0].userArea)
            for (var i = 0; i < regiondis.length; i++) {
            	if (regiondis[i].userArea == "29")
    				data[0].value = data[0].value + 1;
    			if (regiondis[i].userArea == "23")
    				data[1].value = data[1].value + 1;
    			if (regiondis[i].userArea == "04")
    				data[2].value = data[2].value + 1;
    			if (regiondis[i].userArea == "07")
    				data[3].value = data[3].value + 1;
    			if (regiondis[i].userArea == "06")
    				data[4].value = data[4].value + 1;
    			if (regiondis[i].userArea == "24")
    				data[5].value = data[5].value + 1;
    			if (regiondis[i].userArea == "31")
    				data[6].value = data[6].value + 1;
    			if (regiondis[i].userArea == "09")
    				data[7].value = data[7].value + 1;
    			if (regiondis[i].userArea == "18")
    				data[8].value = data[8].value + 1;
    			if (regiondis[i].userArea == "17")
    				data[9].value = data[9].value + 1;
    			if (regiondis[i].userArea == "20")
    				data[10].value = data[10].value + 1;
    			if (regiondis[i].userArea == "16")
    				data[11].value = data[11].value + 1;
    			if (regiondis[i].userArea == "21")
    				data[12].value = data[12].value + 1;
    			if (regiondis[i].userArea == "19")
    				data[13].value = data[13].value + 1;
    			if (regiondis[i].userArea == "26")
    				data[14].value = data[14].value + 1;
    			if (regiondis[i].userArea == "25")
    				data[15].value = data[15].value + 1;
    			if (regiondis[i].userArea == "15")
    				data[16].value = data[16].value + 1;
    			if (regiondis[i].userArea == "08")
    				data[17].value = data[5].value + 1;
    			if (regiondis[i].userArea == "02")
    				data[18].value = data[18].value + 1;
    			if (regiondis[i].userArea == "30")
    				data[19].value = data[19].value + 1;
    			if (regiondis[i].userArea == "32")
    				data[20].value = data[20].value + 1;
    			if (regiondis[i].userArea == "22")
    				data[21].value = data[21].value + 1;
    			if (regiondis[i].userArea == "03")
    				data[22].value = data[22].value + 1;
    			if (regiondis[i].userArea == "05")
    				data[23].value = data[23].value + 1;
    			if (regiondis[i].userArea == "27")
    				data[24].value = data[24].value + 1;
    			if (regiondis[i].userArea == "12")
    				data[25].value = data[25].value + 1;
    			if (regiondis[i].userArea == "11")
    				data[26].value = data[26].value + 1;
    			if (regiondis[i].userArea == "10")
    				data[27].value = data[27].value + 1;
    			if (regiondis[i].userArea == "14")
    				data[28].value = data[28].value + 1;
    			if (regiondis[i].userArea == "00")
    				data[29].value = data[29].value + 1;
    			if (regiondis[i].userArea == "13")
    				data[30].value = data[30].value + 1;
  			}
            console.log(data)
        });
        
        const convertData = function (data) {
        	  var res = [];
        	  for (var i = 0; i < data.length; i++) {
        	    var geoCoord = geoCoordMap[data[i].name];
        	    if (geoCoord) {
        	      res.push({
        	        name: data[i].name,
        	        value: geoCoord.concat(data[i].value)
        	      });
        	    }
        	  }
        	  return res;
        	};
        	
        	option = {
        			  backgroundColor: 'transparent', //适配深色模式
        			  title: {
        			    text: '客户地区分布可视化',
        			    subtext: 'HFUT-深海大菠萝网络代理服务有限公司',
        			    sublink: 'http://www.github.com',
        			    left: 'center',
        			    textStyle: {
        			      color: '#fff'
        			    },
        			    subtextStyle: {
        			      color: '#fff'
        			    }
        			  },
        			  tooltip: {
        			    trigger: 'item'
        			  },
        			  bmap: {
        			    center: [104.114129, 37.550339],
        			    zoom: 5,
        			    roam: true,
        			    mapStyle: {
        			      styleJson: [
        			        {
        			          featureType: 'water',
        			          elementType: 'all',
        			          stylers: {
        			            color: '#044161'
        			          }
        			        },
        			        {
        			          featureType: 'land',
        			          elementType: 'all',
        			          stylers: {
        			            color: '#004981'
        			          }
        			        },
        			        {
        			          featureType: 'boundary',
        			          elementType: 'geometry',
        			          stylers: {
        			            color: '#064f85'
        			          }
        			        },
        			        {
        			          featureType: 'railway',
        			          elementType: 'all',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'highway',
        			          elementType: 'geometry',
        			          stylers: {
        			            color: '#004981'
        			          }
        			        },
        			        {
        			          featureType: 'highway',
        			          elementType: 'geometry.fill',
        			          stylers: {
        			            color: '#005b96',
        			            lightness: 1
        			          }
        			        },
        			        {
        			          featureType: 'highway',
        			          elementType: 'labels',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'arterial',
        			          elementType: 'geometry',
        			          stylers: {
        			            color: '#004981'
        			          }
        			        },
        			        {
        			          featureType: 'arterial',
        			          elementType: 'geometry.fill',
        			          stylers: {
        			            color: '#00508b'
        			          }
        			        },
        			        {
        			          featureType: 'poi',
        			          elementType: 'all',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'green',
        			          elementType: 'all',
        			          stylers: {
        			            color: '#056197',
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'subway',
        			          elementType: 'all',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'manmade',
        			          elementType: 'all',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'local',
        			          elementType: 'all',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'arterial',
        			          elementType: 'labels',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        },
        			        {
        			          featureType: 'boundary',
        			          elementType: 'geometry.fill',
        			          stylers: {
        			            color: '#029fd4'
        			          }
        			        },
        			        {
        			          featureType: 'building',
        			          elementType: 'all',
        			          stylers: {
        			            color: '#1a5787'
        			          }
        			        },
        			        {
        			          featureType: 'label',
        			          elementType: 'all',
        			          stylers: {
        			            visibility: 'off'
        			          }
        			        }
        			      ]
        			    }
        			  },
        			  series: [
        			    {
        			      name: 'pm2.5',
        			      type: 'scatter',
        			      coordinateSystem: 'bmap',
        			      data: convertData(data),
        			      symbolSize: function (val) {
        			        return val[2] / 10;
        			      },
        			      encode: {
        			        value: 2
        			      },
        			      label: {
        			        formatter: '{b}',
        			        position: 'right',
        			        show: false
        			      },
        			      emphasis: {
        			        label: {
        			          show: true
        			        }
        			      }
        			    },
        			    {
        			      name: '地区客户数量',
        			      type: 'effectScatter',
        			      coordinateSystem: 'bmap',
        			      data: convertData(
        			        data
        			          .sort(function (a, b) {
        			            return b.value - a.value;
        			          })
        			          .slice(0, 31)
        			      ),
        			      symbolSize: function (val) {
        			        return val[2] / 10;
        			      },
        			      encode: {
        			        value: 2
        			      },
        			      showEffectOn: 'render',
        			      rippleEffect: {
        			        brushType: 'stroke'
        			      },
        			      label: {
        			        formatter: '{b}',
        			        position: 'right',
        			        show: true
        			      },
        			      itemStyle: {
        			        shadowBlur: 10,
        			        shadowColor: '#333'
        			      },
        			      emphasis: {
        			        scale: true
        			      },
        			      zlevel: 1
        			    }
        			  ]
        			};

        			if (option && typeof option === 'object') {
        			    myChart.setOption(option);
        			}
    </script>
</body>
</html>